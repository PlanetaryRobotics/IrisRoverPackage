<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="file:../xml/ISF_Component_Schema.rnc" type="compact"?>

<component name="IMU" kind="passive" namespace="CubeRover">
  <import_port_type>Fw/Cmd/CmdPortAi.xml</import_port_type>
  <import_port_type>Fw/Cmd/CmdRegPortAi.xml</import_port_type>
  <import_port_type>Fw/Cmd/CmdResponsePortAi.xml</import_port_type>
  <import_port_type>Fw/Log/LogPortAi.xml</import_port_type>
  <import_port_type>Fw/Tlm/TlmPortAi.xml</import_port_type>
  <import_port_type>Svc/Sched/SchedPortAi.xml</import_port_type>
  <import_port_type>Fw/Time/TimePortAi.xml</import_port_type>
  <import_port_type>Svc/Ping/PingPortAi.xml</import_port_type>
  <import_port_type>Svc/Ping/PingPortAi.xml</import_port_type>
  <import_port_type>CubeRover/CubeRoverPorts/IMUData/IMUDataPortAi.xml</import_port_type>
    
  <!-- PORTS -->
  <ports>
    
      <!-- Command ports -->
      <!--
      <port name="CmdDisp" data_type="Fw::Cmd" kind="guarded_input" max_number="1" role="Cmd"></port>

      <port name="CmdReg" data_type="Fw::CmdReg" kind="output" max_number="1" role="CmdRegistration"></port>

      <port name="CmdStatus" data_type="Fw::CmdResponse" kind="output" max_number="1" role="CmdResponse"></port>
      -->

      <!-- Logging and telemetry ports -->
      <!--
      <port name="log" data_type="Fw::Log" kind="output" max_number="1" role="LogEvent"></port>

      <port name="tlmOut" data_type="Fw::Tlm" kind="output" role="Telemetry" max_number="1"></port>

      <port name="timeCaller" data_type="Fw::Time" kind="output" max_number="1" role="TimeGet"></port>
      -->

      <!-- Scheduler port -->
      <port name="schedIn" data_type="Svc::Sched" kind="sync_input" max_number="1"></port>

      <!-- Ping ports -->
      <port name="PingIn" data_type="Svc::Ping" kind="sync_input" max_number="1"></port>

      <port name="PingOut" data_type="Svc::Ping" kind="output" max_number="1"></port>

      <!-- TODO -->
      <!-- Still need Mode manager port(s)! -->
      <!-- Or does IMU assume Navigation took care of it?-->

      <!-- IMU Data port -->
      <port name="IMUDataOut" data_type="CubeRoverPorts::IMUData" kind="output" max_number="1"></port>

  </ports>

  <!-- COMMANDS -->
  <commands>
      <command kind="guarded" opcode="0x00" mnemonic="IMU_ReportData">
          <comment>A command to force an IMU data.</comment>
      </command>

      <command kind="guarded" opcode="0x01" mnemonic="IMU_TurnOn">
          <comment>A command to turn on the hardware</comment>
      </command>

      <command kind="guarded" opcode="0x02" mnemonic="IMU_TurnOff">
          <comment>A command to turn off the hardware</comment>
      </command>

  </commands>

  <!-- EVENTS -->
  <events>
    <event id="0" name="IMU_AngleWarning" severity="WARNING_HI" format_string="High roll/tilt angle">
        <comment>A notification that the rover is close to tipping point</comment>
    </event>

    <event id="1" name="IMU_CommunicationFailure" severity="WARNING_HI" format_string="Communication failure with IMU">
      <comment>A notification that a communication has failed</comment>
    </event>

    <event id="2" name="IMU_Powered_ON" severity="COMMAND" format_string="IMU module turned on">
      <comment>A notification that the IMU is powered on</comment>
    </event>

    <event id="3" name="IMU_Powered_OFF" severity="COMMAND" format_string="IMU module turned off">
      <comment>A notification that the IMU is powered off</comment>
    </event>
  </events>

  <!-- TELEMETRY -->
  <telemetry>

    <channel id="0" name="X_Acc" data_type="I16">
      <comment>Accelerometer X</comment>
    </channel>

    <channel id="1" name="Y_Acc" data_type="I16">
      <comment>Accelerometer Y</comment>
    </channel>

    <channel id="2" name="Z_Acc" data_type="I16">
      <comment>Accelerometer Z</comment>
    </channel>

    <channel id="3" name="X_Ang" data_type="U16">
      <comment>Gyrometer X</comment>
    </channel>

    <channel id="4" name="Y_Ang" data_type="U16">
      <comment>Gyrometer Y</comment>
    </channel>

    <channel id="5" name="Z_Ang" data_type="U16">
      <comment>Gyrometer Z</comment>
    </channel>
  </telemetry>

</component>